<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Phorcys 2.0</title>

    <!-- Favicons -->
    <link rel="icon" sizes="16x16" href="/icons/DiveFlag16.png">
    <link rel="icon" sizes="32x32" href="/icons/DiveFlag32.png">
    <link rel="icon" sizes="48x48" href="/icons/DiveFlag48.png">

    <!-- Bootstrap and Site Styles -->
    <environment names="Development">
        <link rel="stylesheet" href="~/lib/bootstrap/css/bootstrap.css" />
    </environment>
    <environment names="Staging,Production">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
              asp-fallback-href="~/lib/bootstrap/css/bootstrap.css"
              asp-fallback-test-class="sr-only" asp-fallback-test-property="position" asp-fallback-test-value="absolute"
              crossorigin="anonymous" />
    </environment>

    <!-- Telerik Kendo UI Theme - CDN with fallback -->
    <environment names="Development">
        <link href="~/lib/kendo-ui/styles/classic-main.css" id="telerikThemeLink" rel="stylesheet" type="text/css" />
    </environment>
    <environment names="Staging,Production">
        <link href="https://kendo.cdn.telerik.com/2023.3.1114/styles/kendo.classic.min.css"
              id="telerikThemeLink"
              rel="stylesheet"
              asp-fallback-href="~/lib/kendo-ui/styles/classic-main.css"
              asp-fallback-test-class="k-widget"
              asp-fallback-test-property="font-size"
              asp-fallback-test-value="14px" />
    </environment>

    <!-- Scripts with CDN performance -->
    <environment names="Development">
        <script src="~/lib/jquery/jquery.min.js"></script>
        <script src="~/lib/kendo-ui/js/jszip.min.js"></script>
        <script src="~/lib/kendo-ui/js/kendo.all.min.js"></script>
        <script src="~/lib/kendo-ui/js/kendo.aspnetmvc.min.js"></script>
    </environment>
    <environment names="Staging,Production">
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"
                asp-fallback-src="~/lib/jquery/jquery.min.js"
                asp-fallback-test="window.jQuery"
                crossorigin="anonymous"></script>
        <!-- Kendo UI files remain local since they're licensed and not available on public CDNs -->
        <script src="~/lib/kendo-ui/js/jszip.min.js"></script>
        <script src="~/lib/kendo-ui/js/kendo.all.min.js"></script>
        <script src="~/lib/kendo-ui/js/kendo.aspnetmvc.min.js"></script>
    </environment>

    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="stylesheet" href="~/css/Phorcys.css" />

</head>
<body class="k-content">

    <!-- Navbar -->
    <nav>
        <div class="container-fluid d-flex justify-content-between p-0">
            <a class="navbar-brand d-flex align-items-center" asp-controller="Home" asp-action="Index">Phorcys 2.0</a>

            <button id="configure" class="k-rpanel-toggle k-button k-button-md k-button-rectangle k-button-solid-primary btn-toggle">
                <span class="menu"></span>
            </button>
        </div>
    </nav>

    <!-- Logged-in User Display -->
    <div class="container-fluid">
        <div class="d-flex justify-content-end align-items-center mt-2 me-3" id="logindisplay">
            @Html.Partial("LogOnUserControl")
        </div>
    </div>

    <!-- Responsive Menu -->
    <div id="responsive-panel" class="navbar navbar-dark bg-light mb-4">
        <kendo-responsivepanel name="responsive-panel" auto-close="false" breakpoint="768" orientation="top">
            @(
                Html.Kendo().Menu()
                .Name("Menu")
                .Items(items =>
                {
                    items.Add().Text("Home").Action("Index", "Home", new { area = "" });

                    items.Add().Text("Gear").Items(child =>
                    {
                        child.Add().Text("Add Gear").Action("Create", "Gear");
                        child.Add().Text("Display Gear").Action("Index", "Gear");
                    });

                    items.Add().Text("Locations").Items(child =>
                    {
                        child.Add().Text("Add a Location").Action("Create", "Location");
                        child.Add().Text("Display Locations").Action("Index", "Location");
                        child.Add().Text("Add a Site").Action("Create", "Site");
                        child.Add().Text("Display Sites").Action("Index", "Site");
                        child.Add().Text("Show Map").Action("Map", "Site");
                    });

                    items.Add().Text("Dives").Items(child =>
                    {
                        child.Add().Text("Create Dive Plan").Action("Create", "DivePlan");
                        child.Add().Text("Display Dive Plans").Action("Index", "DivePlan");
                        child.Add().Text("Log Dive").Action("Create", "Dive");
                        child.Add().Text("Display Dives").Action("Index", "Dive");
                    });

                    items.Add().Text("Certifications").Items(child =>
                    {
                        child.Add().Text("Agency Certifications").Action("ComingSoon", "Home");
                        child.Add().Text("My Certifications").Action("Index", "MyCertification");
                    });

                    items.Add().Text("Contacts").Items(child =>
                    {
                        child.Add().Text("Add Contact").Action("Create", "Contact");
                        child.Add().Text("Display Contacts").Action("Index", "Contact");
                    });

                    items.Add().Text("Checklists").Items(child =>
                    {
                        child.Add().Text("Create Checklist").Action("Create", "Checklist");
                        child.Add().Text("Display Checklists").Action("Index", "Checklist");
                    });

                    items.Add().Text("Calculators").Items(child =>
                    {
                        child.Add().Text("MOD & END").Action("Index", "ModEnd");
                        child.Add().Text("END").Action("Index", "End");
                    });

                    items.Add().Text("About").Action("About", "Home");

                    if (User.Identity.IsAuthenticated)
                    {
                        items.Add().Text("Logout").Url("/Identity/Account/Logout");
                    }
                    else
                    {
                        items.Add().Text("Login").Url("/Identity/Account/Login");
                    }
                })
                )
        </kendo-responsivepanel>
    </div>

    <!-- Main Content -->
    <main>
        <div class="container-fluid">
            @RenderBody()
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer text-center d-flex align-items-center">
        <div class="container-fluid">
            <p class="text-muted">
                <!-- Optional footer text -->
            </p>
        </div>
    </footer>

    <!-- Bootstrap Scripts -->
    <environment names="Development">
        <script src="~/lib/bootstrap/js/bootstrap.js"></script>
    </environment>
    <environment names="Staging,Production">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
                asp-fallback-src="~/lib/bootstrap/js/bootstrap.bundle.min.js"
                asp-fallback-test="window.jQuery && window.jQuery.fn && window.jQuery.fn.modal"></script>
    </environment>

    <script src="~/js/site.js"></script>
    @RenderSection("scripts", required: false)
</body>
</html>
